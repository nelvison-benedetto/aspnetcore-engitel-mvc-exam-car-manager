@model EngitelExam.Web.Models.ViewModels.CalendarioVM

@{
    string[] mesi = { "Gennaio", "Febbraio", "Marzo", "Aprile", "Maggio", "Giugno",
                      "Luglio", "Agosto", "Settembre", "Ottobre", "Novembre", "Dicembre" };
}
@{
    var firstDayOfMonth = new DateTime(Model.Year, Model.Month, 1);
    int startDayOfWeek = (int)firstDayOfMonth.DayOfWeek;  //0=Sunday, 1=Monday, ect
}

<div class="d-flex justify-content-between align-items-center mb-3">
    <h2>@mesi[Model.Month - 1] @Model.Year</h2>

    <div>
        <a href="@Url.Action("Calendario", new { year = Model.Year, month = Model.Month - 1 })"
           class="btn btn-outline-primary btn-sm">&lt; Precedente</a>
        <a href="@Url.Action("Calendario", new { year = Model.Year, month = Model.Month + 1 })"
           class="btn btn-outline-primary btn-sm">Successivo &gt;</a>
    </div>
</div>


<div class="calendar-container mb-4">
    <div class="d-grid" style="grid-template-columns: repeat(7, 1fr); gap: 0.5rem;">
        @* Intestazione giorni della settimana *@
        <div class="text-center fw-bold">Dom</div>
        <div class="text-center fw-bold">Lun</div>
        <div class="text-center fw-bold">Mar</div>
        <div class="text-center fw-bold">Mer</div>
        <div class="text-center fw-bold">Gio</div>
        <div class="text-center fw-bold">Ven</div>
        <div class="text-center fw-bold">Sab</div>

        @* Spazi vuoti prima del primo giorno *@
        @for (int i = 0; i < startDayOfWeek; i++)
        {
            <div></div>
        }

        @* Caselle dei giorni *@
        @foreach (var day in Model.Days)
        {
            string badgeClass = day.AppuntamentiCount > 0 ? "bg-primary" : "bg-light text-dark";
            <div class="card text-center @(day.AppuntamentiCount>0? "border-primary":"border-secondary" )">
                <div class="card-body p-2">
                    <div class="fw-bold">@day.Date.Day</div>
                    <span class="badge @badgeClass">@day.AppuntamentiCount appuntamenti</span>
                    <div class="mt-2">
                        @*<a class="btn btn-sm btn-outline-primary w-100"
          href="@(day.DayId == 0 ? "#" : Url.Action("Giorno", "Calendario", new { dayId = day.DayId }))"  @(day.DayId == 0 ? "disabled" : "")>
              Dettagli
        </a>*@
                        @*<p>day.appuntamentiCount @day.AppuntamentiCount</p>
                        <p>day.DaiId  @day.DayId</p>
                        <p>@day.Date</p>*@
                        @if (day.AppuntamentiCount > 0)
                        {
                            <a class="btn btn-sm btn-outline-primary w-100"
                               href="@(day.DayId == 0 ? "#" : Url.Action("Giorno", "Calendario", new { dayId = day.DayId }))" @(day.DayId == 0 ? "disabled" : "")>
                                (@day.AppuntamentiCount) appuntamenti
                            </a>
                        }
                        else
                        {
                            <a class="btn btn-sm btn-primary w-100" href="@Url.Action("FissaAppuntamento", "Calendario", new { dayId = day.DayId, date = day.Date.ToString("yyyy-MM-dd") })">
                                Nuovo appuntamento
                            </a> //usa formattazione ISO x no problems conversions
                        }
                    </div>
                </div>
            </div>
        }
    </div>
</div>

<style>
    .calendar-container .card {
        min-height: 100px;
        cursor: pointer;
        transition: transform 0.15s;
    }

        .calendar-container .card:hover {
            transform: scale(1.05);
        }
</style>
